<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/blocking-proxy/README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#blocking-proxy">Blocking Proxy </a>
      </div>

      <div class="heading h1">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h1">
        <a href="#features">Features</a>
      </div>

      <div class="heading h2">
        <a href="#wait-for-angular">Wait for Angular</a>
      </div>

      <div class="heading h2">
        <a href="#highlight-delay">Highlight Delay</a>
      </div>

      <div class="heading h2">
        <a href="#webdriver-logging">WebDriver logging</a>
      </div>

      <div class="heading h1">
        <a href="#development">Development</a>
      </div>

      <div class="heading h2">
        <a href="#formatting-and-lint">Formatting and lint</a>
      </div>

      <div class="heading h2">
        <a href="#running-tests">Running tests</a>
      </div>

      <div class="heading h2">
        <a href="#running-e2e-tests">Running e2e tests</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="blocking-proxy">
  <h1>
    <a href="#blocking-proxy" name="blocking-proxy" class="pilcrow"></a>
Blocking Proxy <a href="https://circleci.com/gh/angular/blocking-proxy"><img src="https://circleci.com/gh/angular/blocking-proxy.svg?style=shield" alt="Build Status"></a>
  </h1>
</div>
<p>Blocking Proxy is a tool for adding functionality to WebDriver-based
tests.  It sits between your tests and the Selenium Server. For each
WebDriver command, it runs a set of 'barriers' that will block
forwarding the command to the Selenium server until some condition
is met.</p>
<p>Because it interacts with WebDriver at the network level, Blocking Proxy can be
used regardless of which language your tests are written in. See <a href="https://github.com/angular/blocking-proxy/blob/master/examples/README.md">the example</a>
for a demonstration of using Blocking Proxy with WebDriver tests written in Python.</p>
<p>Although Blocking Proxy can handle multiple WebDriver sessions, it can not yet handle
multiple concurrent clients. Thus, it's recommended to start a separate instance
for each test process.</p>
<div class="pilwrap" id="usage">
  <h1>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h1>
</div>
<p>Blocking Proxy can be installed globally with <code>npm install -g blocking-proxy</code>.
You can also use it by cloning this repo and running these commands:</p>
<pre><code>npm install
webdriver-manager update &amp;&amp; webdriver-manager start (in another terminal)
node ./built/lib/bin.js --seleniumAddress http://localhost:4444/wd/hub
</code></pre>
<div class="pilwrap" id="features">
  <h1>
    <a href="#features" name="features" class="pilcrow"></a>
Features
  </h1>
</div>
<div class="pilwrap" id="wait-for-angular">
  <h2>
    <a href="#wait-for-angular" name="wait-for-angular" class="pilcrow"></a>
Wait for Angular
  </h2>
</div>
<p>When testing an Angular application, Blocking Proxy can block webdriver commands
until Angular's change detection is finished, and thus make your tests less flaky.</p>
<div class="pilwrap" id="highlight-delay">
  <h2>
    <a href="#highlight-delay" name="highlight-delay" class="pilcrow"></a>
Highlight Delay
  </h2>
</div>
<p>If <code>--highlightDelay &lt;delayMS&gt;</code> is specified, Blocking Proxy will wait for
the specified delay (in milliseconds) before executing click commands or sending
keys. It will also highlight the element that is the target of the command.</p>
<p>Here's an example of highlight delay in action:</p>
<p><img src="http://i.giphy.com/jg7B2HHPIkwak.gif" alt="Highlight Delay"></p>
<div class="pilwrap" id="webdriver-logging">
  <h2>
    <a href="#webdriver-logging" name="webdriver-logging" class="pilcrow"></a>
WebDriver logging
  </h2>
</div>
<p>When <code>--logDir &lt;path&gt;</code> is set, Blocking Proxy will create a readable log of
WebDriver commands at the specified path. The log will look something like this:</p>
<pre><code>20:08:14.830 |    834ms | 37f13c | NewSession
    {&quot;browserName&quot;:&quot;chrome&quot;}
20:08:15.674 |      4ms | 37f13c | SetTimeouts
20:08:15.681 |    578ms | 37f13c | Go http://localhost:8081/ng1/#/interaction
20:08:16.300 |    438ms | 37f13c | FindElement
    Using css selector \'.invalid\'
    ERROR: no such element
</code></pre>
<p>Each line shows the command that was executed and how long it took. For some
commands, extra data or the response from WebDriver will be shown on following
lines.</p>
<div class="pilwrap" id="development">
  <h1>
    <a href="#development" name="development" class="pilcrow"></a>
Development
  </h1>
</div>
<div class="pilwrap" id="formatting-and-lint">
  <h2>
    <a href="#formatting-and-lint" name="formatting-and-lint" class="pilcrow"></a>
Formatting and lint
  </h2>
</div>
<p><code>gulp format</code> runs clang-format. <code>gulp lint</code> validates format and runs tslint.</p>
<div class="pilwrap" id="running-tests">
  <h2>
    <a href="#running-tests" name="running-tests" class="pilcrow"></a>
Running tests
  </h2>
</div>
<p>Unit tests live in <code>spec/unit</code> and can be run with <code>npm test</code>. Run <code>npm run test:auto</code> to automatically watch for changes and run unit tests.</p>
<div class="pilwrap" id="running-e2e-tests">
  <h2>
    <a href="#running-e2e-tests" name="running-e2e-tests" class="pilcrow"></a>
Running e2e tests
  </h2>
</div>
<p>Start webdriver</p>
<pre><code>webdriver-manager update
webdriver-manager start
</code></pre>
<p>in another terminal, start the testapp</p>
<pre><code>npm run testapp 
</code></pre>
<p>Start the proxy with</p>
<pre><code>npm start
</code></pre>
<p>in yet another terminal, run the tests</p>
<pre><code>npm run test:e2e
</code></pre>
</div>
  </div>
</body>
</html>
