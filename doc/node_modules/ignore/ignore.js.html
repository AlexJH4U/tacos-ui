<!DOCTYPE html>
<html>
<head>
  <title>ignore.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/ignore/ignore.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h2">
        <a href="#windows">Windows</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>ignore.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> _createClass = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defineProperties</span>(<span class="hljs-params">target, props</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; props.length; i++) { <span class="hljs-keyword">var</span> descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || <span class="hljs-literal">false</span>; descriptor.configurable = <span class="hljs-literal">true</span>; <span class="hljs-keyword">if</span> (<span class="hljs-string">"value"</span> <span class="hljs-keyword">in</span> descriptor) descriptor.writable = <span class="hljs-literal">true</span>; <span class="hljs-built_in">Object</span>.defineProperty(target, descriptor.key, descriptor); } } <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Constructor, protoProps, staticProps</span>) </span>{ <span class="hljs-keyword">if</span> (protoProps) defineProperties(Constructor.prototype, protoProps); <span class="hljs-keyword">if</span> (staticProps) defineProperties(Constructor, staticProps); <span class="hljs-keyword">return</span> Constructor; }; }();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_classCallCheck</span>(<span class="hljs-params">instance, Constructor</span>) </span>{ <span class="hljs-keyword">if</span> (!(instance <span class="hljs-keyword">instanceof</span> Constructor)) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">"Cannot call a class as a function"</span>); } }

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IgnoreBase();
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>A simple implementation of make-array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">make_array</span>(<span class="hljs-params">subject</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.isArray(subject) ? subject : [subject];
}

<span class="hljs-keyword">var</span> REGEX_BLANK_LINE = <span class="hljs-regexp">/^\s+$/</span>;
<span class="hljs-keyword">var</span> REGEX_LEADING_EXCAPED_EXCLAMATION = <span class="hljs-regexp">/^\\\!/</span>;
<span class="hljs-keyword">var</span> REGEX_LEADING_EXCAPED_HASH = <span class="hljs-regexp">/^\\#/</span>;
<span class="hljs-keyword">var</span> SLASH = <span class="hljs-string">'/'</span>;
<span class="hljs-keyword">var</span> KEY_IGNORE = <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span> !== <span class="hljs-string">'undefined'</span> ? <span class="hljs-built_in">Symbol</span>.for(<span class="hljs-string">'node-ignore'</span>)
<span class="hljs-comment">/* istanbul ignore next */</span>
: <span class="hljs-string">'node-ignore'</span>;

<span class="hljs-keyword">var</span> IgnoreBase = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IgnoreBase</span>(<span class="hljs-params"></span>) </span>{
    _classCallCheck(<span class="hljs-keyword">this</span>, IgnoreBase);

    <span class="hljs-keyword">this</span>._rules = [];
    <span class="hljs-keyword">this</span>[KEY_IGNORE] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>._initCache();
  }

  _createClass(IgnoreBase, [{
    <span class="hljs-attr">key</span>: <span class="hljs-string">'_initCache'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_initCache</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>._cache = {};
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>@param {Array.<string>|string|Ignore} pattern</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'add'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">pattern</span>) </span>{
      <span class="hljs-keyword">this</span>._added = <span class="hljs-literal">false</span>;

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> pattern === <span class="hljs-string">'string'</span>) {
        pattern = pattern.split(<span class="hljs-regexp">/\r?\n/g</span>);
      }

      make_array(pattern).forEach(<span class="hljs-keyword">this</span>._addPattern, <span class="hljs-keyword">this</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Some rules have just added to the ignore,
making the behavior changed.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._added) {
        <span class="hljs-keyword">this</span>._initCache();
      }

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>legacy</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'addPattern'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addPattern</span>(<span class="hljs-params">pattern</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.add(pattern);
    }
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'_addPattern'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_addPattern</span>(<span class="hljs-params">pattern</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>#32</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (pattern &amp;&amp; pattern[KEY_IGNORE]) {
        <span class="hljs-keyword">this</span>._rules = <span class="hljs-keyword">this</span>._rules.concat(pattern._rules);
        <span class="hljs-keyword">this</span>._added = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._checkPattern(pattern)) {
        <span class="hljs-keyword">var</span> rule = <span class="hljs-keyword">this</span>._createRule(pattern);
        <span class="hljs-keyword">this</span>._added = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>._rules.push(rule);
      }
    }
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'_checkPattern'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_checkPattern</span>(<span class="hljs-params">pattern</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<blockquote>
<p>A blank line matches no files, so it can serve as a separator for readability.</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">return</span> pattern &amp;&amp; <span class="hljs-keyword">typeof</span> pattern === <span class="hljs-string">'string'</span> &amp;&amp; !REGEX_BLANK_LINE.test(pattern)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<blockquote>
<p>A line starting with # serves as a comment.</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">      &amp;&amp; pattern.indexOf(<span class="hljs-string">'#'</span>) !== <span class="hljs-number">0</span>;
    }
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'filter'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params">paths</span>) </span>{
      <span class="hljs-keyword">var</span> _this = <span class="hljs-keyword">this</span>;

      <span class="hljs-keyword">return</span> make_array(paths).filter(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">path</span>) </span>{
        <span class="hljs-keyword">return</span> _this._filter(path);
      });
    }
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'createFilter'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFilter</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> _this2 = <span class="hljs-keyword">this</span>;

      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">path</span>) </span>{
        <span class="hljs-keyword">return</span> _this2._filter(path);
      };
    }
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'ignores'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ignores</span>(<span class="hljs-params">path</span>) </span>{
      <span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>._filter(path);
    }
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'_createRule'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_createRule</span>(<span class="hljs-params">pattern</span>) </span>{
      <span class="hljs-keyword">var</span> origin = pattern;
      <span class="hljs-keyword">var</span> negative = <span class="hljs-literal">false</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<blockquote>
<p>An optional prefix &quot;!&quot; which negates the pattern;</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (pattern.indexOf(<span class="hljs-string">'!'</span>) === <span class="hljs-number">0</span>) {
        negative = <span class="hljs-literal">true</span>;
        pattern = pattern.substr(<span class="hljs-number">1</span>);
      }

      pattern = pattern
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<blockquote>
<p>Put a backslash (&quot;&quot;) in front of the first &quot;!&quot; for patterns that begin with a literal &quot;!&quot;, for example, <code>&quot;\!important!.txt&quot;</code>.</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">      .replace(REGEX_LEADING_EXCAPED_EXCLAMATION, <span class="hljs-string">'!'</span>)
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<blockquote>
<p>Put a backslash (&quot;&quot;) in front of the first hash for patterns that begin with a hash.</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">      .replace(REGEX_LEADING_EXCAPED_HASH, <span class="hljs-string">'#'</span>);

      <span class="hljs-keyword">var</span> regex = make_regex(pattern, negative);

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">origin</span>: origin,
        <span class="hljs-attr">pattern</span>: pattern,
        <span class="hljs-attr">negative</span>: negative,
        <span class="hljs-attr">regex</span>: regex
      };
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>@returns <code>Boolean</code> true if the <code>path</code> is NOT ignored</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'_filter'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_filter</span>(<span class="hljs-params">path, slices</span>) </span>{
      <span class="hljs-keyword">if</span> (!path) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }

      <span class="hljs-keyword">if</span> (path <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>._cache) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._cache[path];
      }

      <span class="hljs-keyword">if</span> (!slices) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>path/to/a.js
['path', 'to', 'a.js']</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        slices = path.split(SLASH);
      }

      slices.pop();

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._cache[path] = slices.length
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<blockquote>
<p>It is not possible to re-include a file if a parent directory of that file is excluded.
If the path contains a parent directory, check the parent first</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">      ? <span class="hljs-keyword">this</span>._filter(slices.join(SLASH) + SLASH, slices) &amp;&amp; <span class="hljs-keyword">this</span>._test(path)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Or only test the path</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      : <span class="hljs-keyword">this</span>._test(path);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>@returns {Boolean} true if a file is NOT ignored</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
  }, {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'_test'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_test</span>(<span class="hljs-params">path</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Explicitly define variable type by setting matched to <code>0</code></p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">var</span> matched = <span class="hljs-number">0</span>;

      <span class="hljs-keyword">this</span>._rules.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">rule</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>if matched = true, then we only test negative rules
if matched = false, then we test non-negative rules</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (!(matched ^ rule.negative)) {
          matched = rule.negative ^ rule.regex.test(path);
        }
      });

      <span class="hljs-keyword">return</span> !matched;
    }
  }]);

  <span class="hljs-keyword">return</span> IgnoreBase;
}();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<blockquote>
<p>If the pattern ends with a slash,
it is removed for the purpose of the following description,
but it would only find a match with a directory.
In other words, foo/ will match a directory foo and paths underneath it,
but will not match a regular file or a symbolic link foo
(this is consistent with the way how pathspec works in general in Git).
'<code>foo/</code>' will not match regular file '<code>foo</code>' or symbolic link '<code>foo</code>'
-&gt; ignore-rules will not deal with it, because it costs extra <code>fs.stat</code> call
you could use option <code>mark: true</code> with <code>glob</code></p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>'<code>foo/</code>' should not continue with the '<code>..</code>'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">

<span class="hljs-keyword">var</span> DEFAULT_REPLACER_PREFIX = [

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<blockquote>
<p>Trailing spaces are ignored unless they are quoted with backslash (&quot;&quot;)</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">[
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>(a\ ) -&gt; (a )
(a  ) -&gt; (a)
(a \ ) -&gt; (a  )</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">/\\?\s+$/, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match</span>) </span>{
  <span class="hljs-keyword">return</span> match.indexOf(<span class="hljs-string">'\\'</span>) === <span class="hljs-number">0</span> ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>;
}],

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>replace (\ ) with ' '</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[<span class="hljs-regexp">/\\\s/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">' '</span>;
}],

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>Escape metacharacters
which is written down by users but means special for regular expressions.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<blockquote>
<p>There are 12 characters with special meanings:</p>
<ul>
<li>the backslash ,</li>
<li>the caret ^,</li>
<li>the dollar sign $,</li>
<li>the period or dot .,</li>
<li>the vertical bar or pipe symbol |,</li>
<li>the question mark ?,</li>
<li>the asterisk or star *,</li>
<li>the plus sign +,</li>
<li>the opening parenthesis (,</li>
<li>the closing parenthesis ),</li>
<li>and the opening square bracket [,</li>
<li>the opening curly brace {,
These special characters are often called &quot;metacharacters&quot;.</li>
</ul>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">[<span class="hljs-regexp">/[\\\^$.|?*+()\[{]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'\\'</span> + match;
}],

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>leading slash</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<blockquote>
<p>A leading slash matches the beginning of the pathname.
For example, &quot;/*.c&quot; matches &quot;cat-file.c&quot; but not &quot;mozilla-sha1/sha1.c&quot;.
A leading slash matches the beginning of the pathname</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">/^\<span class="hljs-comment">//, function () {</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">'^'</span>;
}],

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>replace special metacharacter slash after the leading slash</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[<span class="hljs-regexp">/\//g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'\\/'</span>;
}], [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<blockquote>
<p>A leading &quot;<strong>&quot; followed by a slash means match in all directories.
For example, &quot;</strong>/foo&quot; matches file or directory &quot;foo&quot; anywhere,
the same as pattern &quot;foo&quot;.
&quot;<em><em>/foo/bar&quot; matches file or directory &quot;bar&quot; anywhere that is directly under directory &quot;foo&quot;.
Notice that the '</em>'s have been replaced as '\</em>'</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">/^\^*\\\*\\\*\\\<span class="hljs-comment">//,</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>'**/foo' &lt;-&gt; 'foo'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'^(?:.*\\/)?'</span>;
}]];

<span class="hljs-keyword">var</span> DEFAULT_REPLACER_SUFFIX = [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>starting</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>there will be no leading '/' (which has been replaced by section &quot;leading slash&quot;)
If starts with '**', adding a '^' to the regular expression also works</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">/^(?=[^\^])/, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> !<span class="hljs-regexp">/\/(?!$)/</span>.test(<span class="hljs-keyword">this</span>)
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<blockquote>
<p>If the pattern does not contain a slash /, Git treats it as a shell glob pattern
Actually, if there is only a trailing slash, git also treats it as a shell glob pattern</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">  ? <span class="hljs-string">'(?:^|\\/)'</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<blockquote>
<p>Otherwise, Git treats the pattern as a shell glob suitable for consumption by fnmatch(3)</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">  : <span class="hljs-string">'^'</span>;
}],

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<p>two globstars</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>Use lookahead assertions so that we could match more than one <code>'/**'</code></p>

        </td>
        <td class="code highlight">
          <pre class="javascript">/\\\/\\\*\\\*(?=\\\/|$)/g,

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<p>Zero, one or several directories
should not use '*', or it will be replaced by the next replacer</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<p>Check if it is not the last <code>'/**'</code></p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match, index, str</span>) </span>{
  <span class="hljs-keyword">return</span> index + <span class="hljs-number">6</span> &lt; str.length

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<p>case: /**/</p>
<blockquote>
<p>A slash followed by two consecutive asterisks then a slash matches zero or more directories.
For example, &quot;a/<strong>/b&quot; matches &quot;a/b&quot;, &quot;a/x/b&quot;, &quot;a/x/y/b&quot; and so on.
'/</strong>/'</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">  ? <span class="hljs-string">'(?:\\/[^\\/]+)*'</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<p>case: /**</p>
<blockquote>
<p>A trailing <code>&quot;/**&quot;</code> matches everything inside.</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<p>#21: everything inside but it should not include the current folder</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  : <span class="hljs-string">'\\/.+'</span>;
}],

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42"></a>
</div>
<p>intermediate wildcards</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<p>Never replace escaped '<em>'
ignore rule '*' will match the path '</em>'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>'abc.<em>/' -&gt; go
'abc.</em>'  -&gt; skip this rule</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">/(^|[^\\]+)\\\*(?=.+)/g,

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>'<em>.js' matches '.js'
'</em>.js' doesn't match 'abc'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match, p1</span>) </span>{
  <span class="hljs-keyword">return</span> p1 + <span class="hljs-string">'[^\\/]*'</span>;
}],

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>trailing wildcard</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[<span class="hljs-regexp">/(\^|\\\/)?\\\*$/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match, p1</span>) </span>{
  <span class="hljs-keyword">return</span> (p1
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<p>'^':
'/<em>' does not match ''
'/</em>' does not match everything</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<p>'\/':
'abc/*' does not match 'abc/'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  ? p1 + <span class="hljs-string">'[^/]+'</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<p>'a*' matches 'a'
'a*' matches 'aa'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  : <span class="hljs-string">'[^/]*'</span>) + <span class="hljs-string">'(?=$|\\/$)'</span>;
}], [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>unescape</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">/\\\\\\/g, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'\\'</span>;
}]];

<span class="hljs-keyword">var</span> POSITIVE_REPLACERS = [].concat(DEFAULT_REPLACER_PREFIX, [

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<p>'f'
matches</p>
<ul>
<li>/f(end)</li>
<li>/f/</li>
<li>(start)f(end)</li>
<li>(start)f/
doesn't match</li>
<li>oof</li>
<li>foo
pseudo:
-&gt; (^|/)f(/|$)</li>
</ul>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<p>ending</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<p>'js' will not match 'js.'
'ab' will not match 'abc'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">/(?:[^*\/])$/,

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<p>'js*' will not match 'a.js'
'js/' will not match 'a.js'
'js' will match 'a.js' and 'a.js/'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match</span>) </span>{
  <span class="hljs-keyword">return</span> match + <span class="hljs-string">'(?=$|\\/)'</span>;
}]], DEFAULT_REPLACER_SUFFIX);

<span class="hljs-keyword">var</span> NEGATIVE_REPLACERS = [].concat(DEFAULT_REPLACER_PREFIX, [

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<p>#24, #38
The MISSING rule of <a href="https://git-scm.com/docs/gitignore">gitignore docs</a>
A negative pattern without a trailing wildcard should not
re-include the things inside that directory.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<p>eg:
['node_modules/*', '!node_modules']
should ignore <code>node_modules/a.js</code></p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[<span class="hljs-regexp">/(?:[^*])$/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">match</span>) </span>{
  <span class="hljs-keyword">return</span> match + <span class="hljs-string">'(?=$|\\/$)'</span>;
}]], DEFAULT_REPLACER_SUFFIX);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<p>A simple cache, because an ignore rule only has only one certain meaning</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> cache = {};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<p>@param {pattern}</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">make_regex</span>(<span class="hljs-params">pattern, negative</span>) </span>{
  <span class="hljs-keyword">var</span> r = cache[pattern];
  <span class="hljs-keyword">if</span> (r) {
    <span class="hljs-keyword">return</span> r;
  }

  <span class="hljs-keyword">var</span> replacers = negative ? NEGATIVE_REPLACERS : POSITIVE_REPLACERS;

  <span class="hljs-keyword">var</span> source = replacers.reduce(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prev, current</span>) </span>{
    <span class="hljs-keyword">return</span> prev.replace(current[<span class="hljs-number">0</span>], current[<span class="hljs-number">1</span>].bind(pattern));
  }, pattern);

  <span class="hljs-keyword">return</span> cache[pattern] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(source, <span class="hljs-string">'i'</span>);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="windows">
  <h2>
    <a href="#windows" name="windows" class="pilcrow"></a>
Windows
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-comment">/* istanbul ignore if  */</span>
<span class="hljs-keyword">if</span> (
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60"></a>
</div>
<p>Detect <code>process</code> so that it can run in browsers.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">typeof</span> process !== <span class="hljs-string">'undefined'</span> &amp;&amp; (process.env &amp;&amp; process.env.IGNORE_TEST_WIN32 || process.platform === <span class="hljs-string">'win32'</span>)) {

  <span class="hljs-keyword">var</span> filter = IgnoreBase.prototype._filter;
  <span class="hljs-keyword">var</span> make_posix = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">make_posix</span>(<span class="hljs-params">str</span>) </span>{
    <span class="hljs-keyword">return</span> (<span class="hljs-regexp">/^\\\\\?\\/</span>.test(str) || <span class="hljs-regexp">/[^\x00-\x80]+/</span>.test(str) ? str : str.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>)
    );
  };

  IgnoreBase.prototype._filter = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">path, slices</span>) </span>{
    path = make_posix(path);
    <span class="hljs-keyword">return</span> filter.call(<span class="hljs-keyword">this</span>, path, slices);
  };
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
